<?xml version="1.0"?>
<Schema name="FoodMart">

  <Dimension name="Store">
    <Hierarchy hasAll="true" primaryKey="STORE_ID">
      <Table name="STORE"/>
      <Level name="Store Country" column="STORE_COUNTRY" uniqueMembers="true"/>
      <Level name="Store State" column="STORE_STATE" uniqueMembers="true"/>
      <Level name="Store City" column="STORE_CITY" uniqueMembers="false"/>
      <Level name="Store Name" column="STORE_NAME" uniqueMembers="true">
      </Level>
    </Hierarchy>
  </Dimension>

  <Dimension name="Store Size in SQFT">
    <Hierarchy hasAll="true" primaryKey="STORE_ID">
      <Table name="STORE"/>
      <Level name="Store Sqft" column="STORE_SQFT" type="Numeric" uniqueMembers="true"/>
    </Hierarchy>
  </Dimension>

  <Dimension name="Store Type">
    <Hierarchy hasAll="true" primaryKey="STORE_ID">
      <Table name="STORE"/>
      <Level name="Store Type" column="STORE_TYPE" uniqueMembers="true"/>
    </Hierarchy>
  </Dimension>

  <Dimension name="Time" type="TimeDimension">
    <Hierarchy hasAll="true" primaryKey="TIME_ID">
      <Table name="TIME_BY_DAY"/>
      <Level name="Year" column="THE_YEAR" type="Numeric" uniqueMembers="true"
          levelType="TimeYears"/>
      <Level name="Quarter" column="QUARTER" uniqueMembers="false"
          levelType="TimeQuarters"/>
      <Level name="Week" column="WEEK_OF_YEAR" uniqueMembers="false" type="Numeric"
          levelType="TimeWeeks"/>
    </Hierarchy>
  <!--
    <Hierarchy hasAll="true" primaryKey="TIME_ID">
      <Table name="TIME_BY_DAY"/>
      <Level name="Year" column="THE_YEAR" type="Numeric" uniqueMembers="true"
          levelType="TimeYears"/>
      <Level name="Week" column="WEEK_OF_YEAR" type="Numeric" uniqueMembers="false"
          levelType="TimeWeeks"/>
      <Level name="Day" column="DAY_OF_MONTH" uniqueMembers="false" type="Numeric"
          levelType="TimeDays"/>
    </Hierarchy>
    -->
  </Dimension>

  <Dimension name="Product">
    <Hierarchy hasAll="true" primaryKey="PRODUCT_ID" primaryKeyTable="PRODUCT">
      <Join leftKey="PRODUCT_ID" rightKey="PRODUCT_CLASS_ID">
        <Table name="PRODUCT"/>
        <Table name="PRODUCT_CLASS"/>
      </Join>
      <Level name="Product Family" table="PRODUCT_CLASS" column="PRODUCT_FAMILY"
          uniqueMembers="true"/>
      <Level name="Product Department" table="PRODUCT_CLASS" column="PRODUCT_DEPARTMENT"
          uniqueMembers="false"/>
      <Level name="Product Category" table="PRODUCT_CLASS" column="PRODUCT_CATEGORY"
          uniqueMembers="false"/>
      <Level name="Product Subcategory" table="PRODUCT_CLASS" column="PRODUCT_SUBCATEGORY"
          uniqueMembers="false"/>
      <Level name="Brand Name" table="PRODUCT" column="BRAND_NAME" uniqueMembers="false"/>
      <Level name="Product Name" table="PRODUCT" column="PRODUCT_NAME"
          uniqueMembers="true"/>
    </Hierarchy>
  </Dimension>

  <Dimension name="Warehouse">
    <Hierarchy hasAll="true" primaryKey="WAREHOUSE_ID">
      <Table name="WAREHOUSE"/>
      <Level name="Country" column="WAREHOUSE_COUNTRY" uniqueMembers="true"/>
      <Level name="State Province" column="WAREHOUSE_STATE_PROVINCE" uniqueMembers="true"/>
      <Level name="City" column="WAREHOUSE_CITY" uniqueMembers="false"/>
      <Level name="Warehouse Name" column="WAREHOUSE_NAME" uniqueMembers="true"/>
    </Hierarchy>
  </Dimension>

<!-- Sales -->
<Cube name="Sales">
  <Table name="SALES_FACT_1998"/>

  <DimensionUsage name="Store" source="Store" foreignKey="STORE_ID"/>
  <DimensionUsage name="Time" source="Time" foreignKey="TIME_ID"/>
  <DimensionUsage name="Store Size in SQFT" source="Store Size in SQFT" foreignKey="STORE_ID"/>
  <DimensionUsage name="Store Type" source="Store Type" foreignKey="STORE_ID"/>

  <Measure name="Unit Sales" column="UNIT_SALES" aggregator="sum"
      formatString="Standard"/>
  <Measure name="Store Cost" column="STORE_COST" aggregator="sum"
      formatString="#,###.00"/>
  <Measure name="Store Sales" column="STORE_SALES" aggregator="sum"
      formatString="#,###.00"/>
 
  <CalculatedMember
      name="Profit"
      dimension="Measures">
    <Formula>[Measures].[Store Sales] - [Measures].[Store Cost]</Formula>
    <CalculatedMemberProperty name="FORMAT_STRING" value="$#,##0.00"/>
  </CalculatedMember>
  <CalculatedMember
      name="Profit last Period"
      dimension="Measures"
      formula="COALESCEEMPTY((Measures.[Profit], [Time].PREVMEMBER),    Measures.[Profit])"
      visible="false">
    <CalculatedMemberProperty name="FORMAT_STRING" value="$#,##0.00"/>
  </CalculatedMember>
  <CalculatedMember
      name="Profit Growth"
      dimension="Measures"
      formula="([Measures].[Profit] - [Measures].[Profit last Period]) / [Measures].[Profit last Period]"
      visible="true"
      caption="Gewinn-Wachstum">
    <CalculatedMemberProperty name="FORMAT_STRING" value="0.0%"/>
  </CalculatedMember>
</Cube>

<Cube name="Warehouse">
  <Table name="INVENTORY_FACT_1998"/>
<!--
  <DimensionUsage name="Store" source="Store" foreignKey="STORE_ID"/>
  <DimensionUsage name="Store Size in SQFT" source="Store Size in SQFT" foreignKey="STORE_ID"/>
  <DimensionUsage name="Store Type" source="Store Type" foreignKey="STORE_ID"/>
  <DimensionUsage name="Product" source="Product" foreignKey="PRODUCT_ID"/>
  <Measure name="Store Invoice" column="STORE_INVOICE" aggregator="sum"/>
-->
  <DimensionUsage name="Warehouse" source="Warehouse" foreignKey="WAREHOUSE_ID"/>
  <DimensionUsage name="Time" source="Time" foreignKey="TIME_ID"/>
  
  <Measure name="Warehouse Cost" column="WAREHOUSE_COST" aggregator="sum"/>
  <Measure name="Warehouse Sales" column="WAREHOUSE_SALES" aggregator="sum"/>
  <Measure name="Units Shipped" column="UNITS_SHIPPED" aggregator="sum" />
  <Measure name="Units Ordered" column="UNITS_ORDERED" aggregator="sum" formatString="#.0"/>
  <Measure name="Supply Time" column="SUPPLY_TIME" aggregator="sum"/>
</Cube>

</Schema>
